"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const BASE64_KEYS = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';
const values = new Array(123); // max char code in base64Keys
for (let i = 0; i < 123; ++i) {
    values[i] = 64;
} // fill with placeholder('=') index
for (let i = 0; i < 64; ++i) {
    values[BASE64_KEYS.charCodeAt(i)] = i;
}
// decoded value indexed by base64 char code
const BASE64_VALUES = values;
const HexChars = '0123456789abcdef'.split('');
const _t = ['', '', '', ''];
const UuidTemplate = _t.concat(_t, '-', _t, '-', _t, '-', _t, '-', _t, _t, _t);
const Indices = UuidTemplate.map((x, i) => x === '-' ? NaN : i).filter(isFinite);
// const uuid = 'fcmR3XADNLgJ1ByKhqcC5Z';
// const originalUuid = decodeUuid(uuid); // fc991dd7-0033-4b80-9d41-c8a86a702e59
function _decodeUuid(base64) {
    const strs = base64.split('@');
    const uuid = strs[0];
    if (uuid.length !== 22) {
        return base64;
    }
    UuidTemplate[0] = base64[0];
    UuidTemplate[1] = base64[1];
    for (let i = 2, j = 2; i < 22; i += 2) {
        const lhs = BASE64_VALUES[base64.charCodeAt(i)];
        const rhs = BASE64_VALUES[base64.charCodeAt(i + 1)];
        UuidTemplate[Indices[j++]] = HexChars[lhs >> 2];
        UuidTemplate[Indices[j++]] = HexChars[((lhs & 3) << 2) | rhs >> 4];
        UuidTemplate[Indices[j++]] = HexChars[rhs & 0xF];
    }
    return base64.replace(uuid, UuidTemplate.join(''));
}
let HexMap = {};
{
    for (let i = 0; i < HexChars.length; i++) {
        let char = HexChars[i];
        HexMap[char] = i;
    }
}
// 压缩uuid
function _compressUuid(fullUuid) {
    const strs = fullUuid.split('@');
    const uuid = strs[0];
    if (uuid.length !== 36) {
        return fullUuid;
    }
    let zipUuid = [];
    zipUuid[0] = uuid[0];
    zipUuid[1] = uuid[1];
    let cleanUuid = uuid.replace('-', '').replace('-', '').replace('-', '').replace('-', '');
    for (let i = 2, j = 2; i < 32; i += 3) {
        const left = HexMap[String.fromCharCode(cleanUuid.charCodeAt(i))];
        const mid = HexMap[String.fromCharCode(cleanUuid.charCodeAt(i + 1))];
        const right = HexMap[String.fromCharCode(cleanUuid.charCodeAt(i + 2))];
        zipUuid[j++] = BASE64_KEYS[(left << 2) + (mid >> 2)];
        zipUuid[j++] = BASE64_KEYS[((mid & 3) << 4) + right];
    }
    return fullUuid.replace(uuid, zipUuid.join(''));
}
/**
 * https://forum.cocos.org/t/uuid/96047
 * 直接使用cocos论坛的算法
 */
class Uuid {
    static compressUuid(uuid) {
        return _compressUuid(uuid);
    }
    static decompressUuid(uuid) {
        return _decodeUuid(uuid);
    }
}
exports.default = Uuid;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXVpZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NvdXJjZS91dGlscy91dWlkLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsTUFBTSxXQUFXLEdBQUcsbUVBQW1FLENBQUM7QUFDeEYsTUFBTSxNQUFNLEdBQUcsSUFBSSxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyw4QkFBOEI7QUFDN0QsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLEdBQUcsRUFBRSxFQUFFLENBQUMsRUFBRTtJQUFFLE1BQU0sQ0FBQyxDQUFDLENBQUMsR0FBRyxFQUFFLENBQUM7Q0FBRSxDQUFDLG1DQUFtQztBQUNyRixLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBRSxFQUFFLEVBQUUsQ0FBQyxFQUFFO0lBQUUsTUFBTSxDQUFDLFdBQVcsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUM7Q0FBRTtBQUV2RSw0Q0FBNEM7QUFDNUMsTUFBTSxhQUFhLEdBQUcsTUFBTSxDQUFDO0FBRTdCLE1BQU0sUUFBUSxHQUFHLGtCQUFrQixDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsQ0FBQztBQUU5QyxNQUFNLEVBQUUsR0FBRyxDQUFDLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsQ0FBQyxDQUFDO0FBQzVCLE1BQU0sWUFBWSxHQUFHLEVBQUUsQ0FBQyxNQUFNLENBQUMsRUFBRSxFQUFFLEdBQUcsRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsQ0FBQyxDQUFDO0FBQy9FLE1BQU0sT0FBTyxHQUFHLFlBQVksQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLEtBQUssR0FBRyxDQUFD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QVBELHVCQU9DIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgQkFTRTY0X0tFWVMgPSAnQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLz0nO1xyXG5jb25zdCB2YWx1ZXMgPSBuZXcgQXJyYXkoMTIzKTsgLy8gbWF4IGNoYXIgY29kZSBpbiBiYXNlNjRLZXlzXHJcbmZvciAobGV0IGkgPSAwOyBpIDwgMTIzOyArK2kpIHsgdmFsdWVzW2ldID0gNjQ7IH0gLy8gZmlsbCB3aXRoIHBsYWNlaG9sZGVyKCc9JykgaW5kZXhcclxuZm9yIChsZXQgaSA9IDA7IGkgPCA2NDsgKytpKSB7IHZhbHVlc1tCQVNFNjRfS0VZUy5jaGFyQ29kZUF0KGkpXSA9IGk7IH1cclxuXHJcbi8vIGRlY29kZWQgdmFsdWUgaW5kZXhlZCBieSBiYXNlNjQgY2hhciBjb2RlXHJcbmNvbnN0IEJBU0U2NF9WQUxVRVMgPSB2YWx1ZXM7XHJcblxyXG5jb25zdCBIZXhDaGFycyA9ICcwMTIzNDU2Nzg5YWJjZGVmJy5zcGxpdCgnJyk7XHJcblxyXG5jb25zdCBfdCA9IFsnJywgJycsICcnLCAnJ107XHJcbmNvbnN0IFV1aWRUZW1wbGF0ZSA9IF90LmNvbmNhdChfdCwgJy0nLCBfdCwgJy0nLCBfdCwgJy0nLCBfdCwgJy0nLCBfdCwgX3QsIF90KTtcclxuY29uc3QgSW5kaWNlcyA9IFV1aWRUZW1wbGF0ZS5tYXAoKHgsIGkpID0+IHggPT09ICctJyA/IE5hTiA6IGkpLmZpbHRlcihpc0Zpbml0ZSk7XHJcblxyXG4vLyBjb25zdCB1dWlkID0gJ2ZjbVIzWEFETkxnSjFCeUtocWNDNVonO1xyXG4vLyBjb25zdCBvcmlnaW5hbFV1aWQgPSBkZWNvZGVVdWlkKHV1aWQpOyAvLyBmYzk5MWRkNy0wMDMzLTRiODAtOWQ0MS1jOGE4NmE3MDJlNTlcclxuXHJcbmZ1bmN0aW9uIF9kZWNvZGVVdWlkKGJhc2U2NCkge1xyXG4gICAgY29uc3Qgc3RycyA9IGJhc2U2NC5zcGxpdCgnQCcpO1xyXG4gICAgY29uc3QgdXVpZCA9IHN0cnNbMF07XHJcbiAgICBpZiAodXVpZC5sZW5ndGggIT09IDIyKSB7XHJcbiAgICAgICAgcmV0dXJuIGJhc2U2NDtcclxuICAgIH1cclxuICAgIFV1aWRUZW1wbGF0ZVswXSA9IGJhc2U2NFswXTtcclxuICAgIFV1aWRUZW1wbGF0ZVsxXSA9IGJhc2U2NFsxXTtcclxuICAgIGZvciAobGV0IGkgPSAyLCBqID0gMjsgaSA8IDIyOyBpICs9IDIpIHtcclxuICAgICAgICBjb25zdCBsaHMgPSBCQVNFNjRfVkFMVUVTW2Jhc2U2NC5jaGFyQ29kZUF0KGkpXTtcclxuICAgICAgICBjb25zdCByaHMgPSBCQVNFNjRfVkFMVUVTW2Jhc2U2NC5jaGFyQ29kZUF0KGkgKyAxKV07XHJcbiAgICAgICAgVXVpZFRlbXBsYXRlW0luZGljZXNbaisrXV0gPSBIZXhDaGFyc1tsaHMgPj4gMl07XHJcbiAgICAgICAgVXVpZFRlbXBsYXRlW0luZGljZXNbaisrXV0gPSBIZXhDaGFyc1soKGxocyAmIDMpIDw8IDIpIHwgcmhzID4+IDRdO1xyXG4gICAgICAgIFV1aWRUZW1wbGF0ZVtJbmRpY2VzW2orK11dID0gSGV4Q2hhcnNbcmhzICYgMHhGXTtcclxuICAgIH1cclxuICAgIHJldHVybiBiYXNlNjQucmVwbGFjZSh1dWlkLCBVdWlkVGVtcGxhdGUuam9pbignJykpO1xyXG59XHJcblxyXG5sZXQgSGV4TWFwID0ge31cclxue1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBIZXhDaGFycy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGxldCBjaGFyID0gSGV4Q2hhcnNbaV1cclxuICAgICAgICBIZXhNYXBbY2hhcl0gPSBpXHJcbiAgICB9XHJcbn1cclxuLy8g5Y6L57ypdXVpZFxyXG5mdW5jdGlvbiBfY29tcHJlc3NVdWlkKGZ1bGxVdWlkKSB7XHJcbiAgICBjb25zdCBzdHJzID0gZnVsbFV1aWQuc3BsaXQoJ0AnKTtcclxuICAgIGNvbnN0IHV1aWQgPSBzdHJzWzBdO1xyXG4gICAgaWYgKHV1aWQubGVuZ3RoICE9PSAzNikge1xyXG4gICAgICAgIHJldHVybiBmdWxsVXVpZDtcclxuICAgIH1cclxuXHJcbiAgICBsZXQgemlwVXVpZCA9IFtdXHJcbiAgICB6aXBVdWlkWzBdID0gdXVpZFswXTtcclxuICAgIHppcFV1aWRbMV0gPSB1dWlkWzFdO1xyXG4gICAgbGV0IGNsZWFuVXVpZCA9IHV1aWQucmVwbGFjZSgnLScsICcnKS5yZXBsYWNlKCctJywgJycpLnJlcGxhY2UoJy0nLCAnJykucmVwbGFjZSgnLScsICcnKVxyXG5cclxuICAgIGZvciAobGV0IGkgPSAyLCBqID0gMjsgaSA8IDMyOyBpICs9IDMpIHtcclxuXHJcbiAgICAgICAgY29uc3QgbGVmdCA9IEhleE1hcFtTdHJpbmcuZnJvbUNoYXJDb2RlKGNsZWFuVXVpZC5jaGFyQ29kZUF0KGkpKV07XHJcbiAgICAgICAgY29uc3QgbWlkID0gSGV4TWFwW1N0cmluZy5mcm9tQ2hhckNvZGUoY2xlYW5VdWlkLmNoYXJDb2RlQXQoaSArIDEpKV07XHJcbiAgICAgICAgY29uc3QgcmlnaHQgPSBIZXhNYXBbU3RyaW5nLmZyb21DaGFyQ29kZShjbGVhblV1aWQuY2hhckNvZGVBdChpICsgMikpXTtcclxuXHJcbiAgICAgICAgemlwVXVpZFtqKytdID0gQkFTRTY0X0tFWVNbKGxlZnQgPDwgMikgKyAobWlkID4+IDIpXVxyXG4gICAgICAgIHppcFV1aWRbaisrXSA9IEJBU0U2NF9LRVlTWygobWlkICYgMykgPDwgNCkgKyByaWdodF1cclxuICAgIH1cclxuICAgIHJldHVybiBmdWxsVXVpZC5yZXBsYWNlKHV1aWQsIHppcFV1aWQuam9pbignJykpO1xyXG59XHJcblxyXG4vKipcclxuICogaHR0cHM6Ly9mb3J1bS5jb2Nvcy5vcmcvdC91dWlkLzk2MDQ3XHJcbiAqIOebtOaOpeS9v+eUqGNvY29z6K665Z2b55qE566X5rOVXHJcbiAqL1xyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBVdWlkIHtcclxuICAgIHN0YXRpYyBjb21wcmVzc1V1aWQodXVpZCkge1xyXG4gICAgICAgIHJldHVybiBfY29tcHJlc3NVdWlkKHV1aWQpO1xyXG4gICAgfVxyXG4gICAgc3RhdGljIGRlY29tcHJlc3NVdWlkKHV1aWQpIHtcclxuICAgICAgICByZXR1cm4gX2RlY29kZVV1aWQodXVpZCk7XHJcbiAgICB9XHJcbn0iXX0=